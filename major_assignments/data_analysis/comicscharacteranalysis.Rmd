---
title: "data_analysis_project"
author: "Jon Donville,Varun Shankar, Mythili Devarakonda"
date: "16/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(janitor)
library(tidycensus)
library(stringr)
library(lubridate)

```


## Read in data 

```{r}
marvel_data <- read_csv("data/marvel-wikia-data.csv")
dc_data <- read_csv("data/dc-wikia-data.csv")
```

## Exploratory analysis

1) Marvel Data

The marvel_data dataset consists of 16,376 rows and 13 columns of data on Marvel comic characters. In such a large dataset, only about 90 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}

glimpse(marvel_data)

marvel_data_lgbt <- marvel_data %>% 
  filter (! is.na (GSM)) %>% 
  clean_names()

marvel_data_no_lgbt <- marvel_data %>% 
  filter (is.na (GSM)) %>% 
  clean_names()

```

2) DC Data

The dc_data dataset consists of 6,896 rows and 13 columns of data on DC comic characters. In such a large dataset, only about 64 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}

glimpse(dc_data)

dc_data_lgbt <-dc_data %>% 
  filter (! is.na (GSM)) %>% 
    clean_names()

dc_data_no_lgbt <-dc_data %>% 
  filter (is.na (GSM)) %>% 
    clean_names()


total_lgbt <- rbind(dc_data_lgbt, marvel_data_lgbt)
total_non_lgbt <- rbind(dc_data_no_lgbt, marvel_data_no_lgbt)
```

```{r}
# Create an if/else statement to create new columns that group characters into LGBT or not, and neutral color hair or not.

total_lgbt_hair <- total_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        hair == 'Black Hair' ~ "NEUTRAL",
        hair == 'Blond Hair' ~ "NEUTRAL",
        hair == 'Brown Hair' ~ "NEUTRAL",
        hair == 'Auburn Hair' ~ "NEUTRAL", 
        hair == 'Bald' ~ "NEUTRAL",
        hair == 'Green Hair' ~ "Not",
        hair == 'Blue Hair' ~ "Not",
        hair == 'Gold Hair' ~ "Not", 
        hair == 'Grey Hair' ~ "NEUTRAL",
        hair == 'Orange Hair' ~ "Not",
        hair == 'Pink Hair' ~ "Not",
        hair == 'Platinum Blond Hair' ~ "NEUTRAL", 
        hair == 'Purple Hair' ~ "Not",
        hair == 'Red Hair' ~ "Not",
        hair == 'Reddish Brown Hair' ~ "NEUTRAL",
        hair == 'Silver Hair' ~ "Not", 
        hair == 'Strawberry Blond Hair' ~ "NEUTRAL",
        hair == 'Violet Hair' ~ "Not",
        hair == 'White Hair' ~ "Not",
        
      )
  ) 

total_nonlgbt_hair <- total_non_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        hair == 'Black Hair' ~ "NEUTRAL",
        hair == 'Blond Hair' ~ "NEUTRAL",
        hair == 'Brown Hair' ~ "NEUTRAL",
        hair == 'Auburn Hair' ~ "NEUTRAL", 
        hair == 'Bald' ~ "NEUTRAL",
        hair == 'Green Hair' ~ "Not",
        hair == 'Blue Hair' ~ "Not",
        hair == 'Gold Hair' ~ "Not", 
        hair == 'Grey Hair' ~ "NEUTRAL",
        hair == 'Orange Hair' ~ "Not",
        hair == 'Pink Hair' ~ "Not",
        hair == 'Platinum Blond Hair' ~ "NEUTRAL", 
        hair == 'Purple Hair' ~ "Not",
        hair == 'Red Hair' ~ "Not",
        hair == 'Reddish Brown Hair' ~ "NEUTRAL",
        hair == 'Silver Hair' ~ "Not", 
        hair == 'Strawberry Blond Hair' ~ "NEUTRAL",
        hair == 'Violet Hair' ~ "Not",
        hair == 'White Hair' ~ "Not",
        
      )
  ) 

```
Question 1: What percentage of LGBT comic characters get more than 1 appearance and average appearances?

```{r}
lgbt_characters_overoneapp <- total_lgbt %>% 
    filter(appearances > 1)
nonlgbt_total_characters_overoneapp <- total_non_lgbt %>% 
    filter(appearances > 1)


lgbt_over_one_app_percent <- (count(lgbt_characters_overoneapp)/count(total_lgbt))*100
non_lgbt_over_one_app_percent <- (count(nonlgbt_total_characters_overoneapp)/count(total_non_lgbt))*100

lgbt_app_mean <- mean(total_lgbt$appearances, na.rm = TRUE)
nonlgbt_app_mean <- mean(total_non_lgbt$appearances, na.rm = TRUE)

```

Question 2: What's the alignment of LGBT comic characters?

```{r}
dc_lgbt_heroes <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")
marvel_lgbt_heroes <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")
dclgbtcountgoodguy = count(dc_lgbt_heroes)
marvellgbtcountgoodguy = count(marvel_lgbt_heroes)
 dclgbtcount = count(lgbt_dc_characters)
 marvellgbtcount = count(lgbt_marvel_characters)
 
  ((dclgbtcountgoodguy+marvellgbtcountgoodguy)/(marvellgbtcount+dclgbtcount))*100
```

Question 3: What's the identity status of LGBT characters? (Here: Identity means secret or public or dual identity according to the data)


```{r}
dc_lgbt_secret <- dc_data_lgbt %>% 
  filter(lgbt_or_not == "LGBT" & ID == "Secret Identity")

marvel_lgbt_secret <- marvel_data_lgbt %>% 
  filter(lgbt_or_not == "LGBT" & ID == "Secret Identity")
dc_lgbt_secret_count = count(dc_lgbt_secret)
marvel_lgbt_secret_count = count(marvel_lgbt_secret)
 dc_lgbt_count = count(dc_data_lgbt)
 marvel_lgbt_count = count(marvel_data_lgbt)
 
  ((dc_lgbt_secret_count+marvel_lgbt_secret_count)/(marvel_lgbt_count+dc_lgbt_count))*100
```
Question 4: Whatâ€™s the death rate of LGBT comic characters ?

```{r}
dc_lgbt_alive <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")
marvel_lgbt_alive <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")
dclgbtcountalive= count(dc_lgbt_alive)
marvellgbtcountalive = count(marvel_lgbt_alive)
((dclgbtcountalive+marvellgbtcountalive)/(marvellgbtcount+dclgbtcount))*100
```

Question 5: What percentage of LGBT characters have neutral hair colors? 
```{r}

neutral_hair_lgbt <- total_lgbt_hair %>%  
  filter(neutral_hair_or_not == "NEUTRAL")  
neutral_hair_lgbt_percentage <- (count(neutral_hair_lgbt)/count(total_lgbt_hair))

neutral_hair_non_lgbt <- total_nonlgbt_hair %>% 
   filter(neutral_hair_or_not == "NEUTRAL")  

neutral_hair_nonlgbt_percentage <- (count(neutral_hair_non_lgbt)/count(total_nonlgbt_hair))
``` 